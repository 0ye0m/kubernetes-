the gce-firewall creates a firewall using iptable mange and filter tables.

Here is a sample of the rules that it creates.
Most of the rules are mimicing user-defined rules.
The k8s-svc-firewall rule is the most significant since it only allows traffic from the LoadBalancer

The firewall rules in the mangle table mark packets that are OK to allow.
The firewall rules in the filter table allow packets that are local or marked OK.
Other packets are dropped.

*mangle
:K8S-FIREWALL - [0:0]
-A PREROUTING -j K8S-FIREWALL
-A K8S-FIREWALL -d 104.197.179.82/32 -p tcp -m comment --comment k8s-fw-ab7354dd39ae711e5bba642010af0000 -m tcp --dport 8080 -j MARK --set-xmark 0x70617373/0xffffffff
COMMIT
# Completed on Sat Dec  5 00:33:42 2015
# Generated by iptables-save v1.4.14 on Sat Dec  5 00:33:42 2015
*filter
:INPUT ACCEPT [291:88151]
:FORWARD ACCEPT [124:175178]
:OUTPUT ACCEPT [248:567014]
:DOCKER - [0:0]
:K8S-FIREWALL - [0:0]
-A INPUT -j K8S-FIREWALL
-A FORWARD -o docker0 -j DOCKER
-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i docker0 ! -o docker0 -j ACCEPT
-A FORWARD -i docker0 -o docker0 -j ACCEPT
-A K8S-FIREWALL -m comment --comment allow-outbound-traffic -m conntrack --ctstate RELATED,ESTABLISHED -j RETURN
-A K8S-FIREWALL -m comment --comment allow-local-src-addreses -m addrtype --src-type LOCAL -j RETURN
-A K8S-FIREWALL -s 10.0.0.0/8 -m comment --comment "allow-10.0.0.0/8-addresses" -j RETURN
-A K8S-FIREWALL -s 169.254.0.0/16 -m comment --comment "allow-169.254.0.0/16-addresses" -j RETURN
-A K8S-FIREWALL -s 172.16.0.0/12 -m comment --comment "allow-172.16.0.0/12-addresses" -j RETURN
-A K8S-FIREWALL -s 192.168.0.0/16 -m comment --comment "allow-192.168.0.0/16-addresses" -j RETURN
-A K8S-FIREWALL -s 10.0.0.0/8 -p tcp -m comment --comment default-default-internal -m tcp --dport 1:65535 -j RETURN
-A K8S-FIREWALL -s 10.0.0.0/8 -p udp -m comment --comment default-default-internal -m udp --dport 1:65535 -j RETURN
-A K8S-FIREWALL -s 10.0.0.0/8 -p icmp -m comment --comment default-default-internal -j RETURN
-A K8S-FIREWALL -p tcp -m comment --comment default-default-ssh -m tcp --dport 22 -j RETURN
-A K8S-FIREWALL -s 10.0.0.0/8 -p tcp -m comment --comment e2e-default-internal -m tcp --dport 1:65535 -j RETURN
-A K8S-FIREWALL -s 10.0.0.0/8 -p udp -m comment --comment e2e-default-internal -m udp --dport 1:65535 -j RETURN
-A K8S-FIREWALL -s 10.0.0.0/8 -p icmp -m comment --comment e2e-default-internal -j RETURN
-A K8S-FIREWALL -p tcp -m comment --comment e2e-default-ssh -m tcp --dport 22 -j RETURN
-A K8S-FIREWALL -s 10.245.0.0/16 -p tcp -m comment --comment e2e-test-abshah-minion-all -j RETURN
-A K8S-FIREWALL -s 10.245.0.0/16 -p udp -m comment --comment e2e-test-abshah-minion-all -j RETURN
-A K8S-FIREWALL -s 10.245.0.0/16 -p icmp -m comment --comment e2e-test-abshah-minion-all -j RETURN
-A K8S-FIREWALL -s 10.245.0.0/16 -p esp -m comment --comment e2e-test-abshah-minion-all -j RETURN
-A K8S-FIREWALL -s 10.245.0.0/16 -p ah -m comment --comment e2e-test-abshah-minion-all -j RETURN
-A K8S-FIREWALL -s 10.245.0.0/16 -p sctp -m comment --comment e2e-test-abshah-minion-all -j RETURN
-A K8S-FIREWALL -p tcp -m comment --comment e2e-test-abshah-minion-e2e-test-abshah-nodeports -m tcp --dport 30000:32767 -j RETURN
-A K8S-FIREWALL -p udp -m comment --comment e2e-test-abshah-minion-e2e-test-abshah-nodeports -m udp --dport 30000:32767 -j RETURN
-A K8S-FIREWALL -p tcp -m comment --comment pprof -m tcp --dport 10249 -j RETURN
-A K8S-FIREWALL -m comment --comment k8s-forwarding-rule-traffic -m mark --mark 0x70617373 -j RETURN
-A K8S-FIREWALL -j DROP
COMMIT

